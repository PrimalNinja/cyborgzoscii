// CyborgZOSCII v20250805
// (c) 2025 Cyborg Unicorn Pty Ltd.
// This software is released under MIT License.

/*jsl:ignore*/

function toZOSCII(g,a,m,k,r){var t=(new Date).getTime(),b,s=0,h=0,n=0,p=Array(256),e=Array(256),c=Array(256),q=Array(256),d,l,f;for(b=0;256>b;b++)p[b]=0,q[b]=0;for(b=0;b<m.length;b++){f=m[b];for(d=f.start;d<f.start+f.size;d++)l=g[d],p[l]++}for(b=0;256>b;b++)e[b]=Array(p[b]),c[b]=0;for(b=0;b<m.length;b++){f=m[b];for(d=f.start;d<f.start+f.size;d++)l=g[d],e[l][c[l]]=d,c[l]++}for(b=0;b<a.length;b++)c=a.charCodeAt(b),k&&(c=k(c,r)),0<=c&&256>c&&e[c]&&0<e[c].length?h++:(n++,10>=n&&console.log("Missing character: '"+
a.charAt(b)+"' (code "+a.charCodeAt(b)+" -> "+c+")"));console.log("Characters found in ROM: "+h);console.log("Characters missing from ROM: "+n);h=Array(h);for(b=0;b<a.length;b++)c=a.charCodeAt(b),k&&(c=k(c,r)),0<=c&&(256>c&&e[c]&&0<e[c].length)&&(q[c]++,n=Math.floor(Math.random()*e[c].length),h[s]=e[c][n],s++);k=(new Date).getTime()-t;console.log("ZOSCII Performance:");console.log("- Binary size: "+g.length+" bytes");console.log("- Input length: "+a.length+" chars");console.log("- Memory blocks: "+
m.length);console.log("- Execution time: "+k+"ms");console.log("- Output addresses: "+h.length);return{addresses:h,inputCounts:q,romCounts:p}}
function petsciiToAscii(g,a){return[a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53,54,55,56,57,58,59,60,61,62,63,64,65,66,67,68,69,70,71,72,73,74,75,76,77,78,79,80,81,82,83,84,85,86,87,88,89,90,91,92,93,94,95,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,
a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a][g]}
function ebcdicToAscii(g,a){return[a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,32,a,a,a,a,a,a,a,a,a,a,46,60,40,43,124,38,a,a,a,a,a,a,a,a,a,33,36,a,41,59,a,45,47,a,a,a,a,a,a,a,a,a,44,37,95,62,63,a,a,a,a,a,a,a,a,a,96,58,35,64,39,61,34,a,97,98,99,100,101,102,103,104,105,a,a,a,a,a,a,a,106,107,108,109,110,111,112,113,114,a,a,a,a,a,a,a,a,115,116,117,118,119,120,121,122,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,65,66,
67,68,69,70,71,72,73,a,a,a,a,a,a,a,74,75,76,77,78,79,80,81,82,a,a,a,a,a,a,a,a,83,84,85,86,87,88,89,90,a,a,a,a,a,a,48,49,50,51,52,53,54,55,56,57,a,a,a,a,a,a][g]};
